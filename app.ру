import os
import requests
from flask import Flask, request

app = Flask(__name__)

BOT_TOKEN = os.environ.get("BOT_TOKEN", "")
MEDITATIONS_URL = os.environ.get("MEDITATIONS_URL", "")
TENTARY_URL = os.environ.get("TENTARY_URL", "")

if not BOT_TOKEN:
    raise RuntimeError("BOT_TOKEN is not set")

API = f"https://api.telegram.org/bot{BOT_TOKEN}"

@app.get("/")
def index():
    return "Bot is running | CLEAN VERSION", 200

@app.post("/telegram")
def telegram_webhook():
    data = request.json or {}

    message = data.get("message")
    if not message:
        return {"ok": True}

    text = (message.get("text") or "").lower()
    chat_id = message["chat"]["id"]

    if text.startswith("/start"):
        keyboard = {"inline_keyboard": []}

        if MEDITATIONS_URL:
            keyboard["inline_keyboard"].append(
                [{"text": "ðŸ“© ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¼ÐµÐ´Ð¸Ñ‚Ð°Ñ†Ð¸Ð¸", "url": MEDITATIONS_URL}]
            )

        if TENTARY_URL:
            keyboard["inline_keyboard"].append(
                [{"text": "ðŸ’³ ÐšÑƒÐ¿Ð¸Ñ‚ÑŒ Ð¼ÐµÐ´Ð¸Ñ‚Ð°Ñ†Ð¸Ð¸", "url": TENTARY_URL}]
            )

        requests.post(
            f"{API}/sendMessage",
            json={
                "chat_id": chat_id,
                "text": "Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² Lexxa Quantum âœ¨",
                "reply_markup": keyboard,
if __name__ == "__main__":
    port = int(os.environ.get("PORT", "10000"))
    app.run(host="0.0.0.0", port=port)

            },
            timeout=10,
        )

    return {"ok": True}
